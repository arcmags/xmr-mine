# Maintainer: Chris Magyar <c.magyar.ec@gmail.com>
pkgname=aeon-stak-cpu
pkgver=2.2.0
pkgrel=1
pkgdesc="AEON CPU miner"
arch=('x86_64')
url='https://github.com/fireice-uk/xmr-stak'
license=('GPL3')
makedepends=('cmake')
depends=('libmicrohttpd' 'openssl' 'hwloc')
source=("xmr-stak-${pkgver}.tar.gz::$url/archive/v${pkgver}.tar.gz"
    'no-donate.patch')
md5sums=('320c7ce60c4c5eb3b77e6e0e3c6a55c8'
    'dcaf327fcbc4baebf9e0c8d98c76f787')

prepare() {
    cd "$srcdir/xmr-stak-${pkgver}"
    patch -p1 -i ../no-donate.patch
}

build() {
    cd "$srcdir/xmr-stak-${pkgver}"
    cmake . \
        -DXMR-STAK_CURRENCY=aeon \
        -DOpenCL_ENABLE=OFF \
        -DCUDA_ENABLE=OFF
    make
}

package() {
    cd "$srcdir/xmr-stak-${pkgver}"
    install -D -m755 ./bin/xmr-stak "$pkgdir/usr/bin/aeon-stak"
}
