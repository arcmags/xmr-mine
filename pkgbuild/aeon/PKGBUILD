# Maintainer: Konstantin Shalygin <k0ste@k0ste.ru>
# Contributor: Konstantin Shalygin <k0ste@k0ste.ru>
# Contributor: Chris Magyar <c.magyar.ec@gmail.com>

pkgname=aeon
pkgver=0.12.5.0
pkgrel=1
pkgdesc='Aeon: cryptonote currency daemon and wallet'
url="https://github.com/aeonix/${pkgname}"
depends=('boost-libs' 'openssl' 'zeromq' 'pcsclite' )
makedepends=('git' 'cmake' 'boost' )
license=('custom:Cryptonote')
arch=('x86_64')
source=("${url}/archive/v${pkgver}-${pkgname}.tar.gz")
md5sums=('6ce26e8d203a66ba367b2ec19c0fde12')

prepare() {
	cd "${pkgname}-${pkgver}-${pkgname}"
	git clone \
		git://github.com/monero-project/miniupnp.git external/miniupnp
	git clone \
		git://github.com/monero-project/unbound.git external/unbound
	git -C external/miniupnp checkout monero
	git -C external/unbound checkout monero
}

build() {
	cd "${pkgname}-${pkgver}-${pkgname}"
    mkdir build && cd build
    cmake ..
    make
}

package() {
	cd "${pkgname}-${pkgver}-${pkgname}"
    install -Dm755 "./build/bin/aeon-blockchain-blackball" \
        "${pkgdir}/usr/bin/aeon-blockchain-blackball"
    install -Dm755 "./build/bin/aeon-blockchain-export" \
        "${pkgdir}/usr/bin/aeon-blockchain-export"
    install -Dm755 "./build/bin/aeon-blockchain-import" \
        "${pkgdir}/usr/bin/aeon-blockchain-import"
    install -Dm755 "./build/bin/aeon-blockchain-usage" \
        "${pkgdir}/usr/bin/aeon-blockchain-usage"
    install -Dm755 "./build/bin/aeond" \
        "${pkgdir}/usr/bin/aeond"
    install -Dm755 "./build/bin/aeon-wallet-cli" \
        "${pkgdir}/usr/bin/aeon-wallet-cli"
    install -Dm755 "./build/bin/aeon-wallet-rpc" \
        "${pkgdir}/usr/bin/aeon-wallet-rpc"
    install -Dm644 ./utils/conf/aeond.conf \
        "${pkgdir}/etc/aeond.conf"
    install -Dm644  LICENSE \
        "${pkgdir}/usr/share/licenses/$pkgname/LICENSE"
}
