# Maintainer: Chris Magyar <c.magyar.ec@gmail.com>

pkgname=dero
pkgver=2.1.0
_git=deroproject
_gitname=derosuite
_gitver=V2.1.0
pkgrel=1
pkgdesc='Dero: cryptonote currency daemon and wallet'
arch=( 'x86_64' )
url="https://github.com/$_git/$_gitname"
license=( 'custom:Research' )
makedepends=( 'git' 'go' )
depends=( 'glibc' )
source=("$pkgname-$pkgver.tar.gz::$url/archive/$_gitver.tar.gz")
md5sums=( '937fd74832c0fda20793755c54a28d33' )

build() {
	if ! [ "`uname -m`" = 'x86_64' ]; then
		printf "\e[1;31m==> ERROR:\e[1;37m "
		printf "local machine not x86_64.\n"
		return 1
	fi
	printf "\e[1;34m  ->\e[1;37m "
	printf "go get -u github.com/deroproject/derosuite/...\n"
	go get -u github.com/deroproject/derosuite/...
}

package() {
	cd "$_gitname-$pkgver"
	if [ -z "$GOPATH" ]; then
		GOPATH="$HOME/go"
	fi
    install -Dm755 "$GOPATH/bin/derod" \
		"$pkgdir/usr/bin/derod"
    install -Dm755 "$GOPATH/bin/dero-wallet-cli" \
		"$pkgdir/usr/bin/dero-wallet-cli"
    install -Dm755 "$GOPATH/bin/explorer" \
		"$pkgdir/usr/bin/dero-explorer"
    install -Dm644 LICENSE \
		"${pkgdir}/usr/share/licenses/$pkgname/LICENSE"
}
